<ui:composition template="../../resources/plantilla-cier.xhtml"
                xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:of="http://omnifaces.org/functions">

   <!-- parámetros de la plantilla principal ****************************** -->
    <ui:param name="NOMBRE_MODULO" value="#{etiquetas['consultas.calificacion.filename']}" />
    <ui:param name="NOMBRE_INICIO" value="#{etiquetas['aplicacion.general.breadcrumbInicio']}" />
    <ui:param name="NOMBRE_ACCESO" value="#{etiquetas['aplicacion.general.breadcrumbConsultas']}" />
    <ui:param name="NOMBRE_ACCESO2" value="#{etiquetas['consultas.simulacionCostos.nombreAcceso']}" />
    <!-- Nota: Estos estilos se pueden encontrar en la página "icons.html" 
        del template original -->
    <ui:param name="ESTILO_ICONO_MODULO" value="fa-search" /> 
    <ui:param name="RESUMEN_MODULO" value="#{etiquetas['consultas.simulacionCostos.resumenModulo']}" /> 
    <ui:param name="DESC_MODULO" value="#{etiquetas['consultas.simulacionCostos.descripcionModulo']}" /> 
    <ui:param name="PAGINA_AYUDA" value="#{request.contextPath}/ayudas/#{login.locale.toString()}/calificacion/Calificacion.pdf" /> 

    <ui:define name="breadcrumb" >
        <li>#{NOMBRE_INICIO}</li>
        <li>#{NOMBRE_ACCESO}</li>
        <li class="active">#{NOMBRE_MODULO}</li>
    </ui:define>
    <ui:define name="menuLateral">
        <ui:include src="../../menuLateral/menuConsultas.xhtml" />
    </ui:define>   

    <ui:define name="content">    
        <h:form id="dpaForm" >    
            <div class="col-md-12">
                <div  class="panel">
                    <div class="panel-heading text-primary">
                        <h3 class="panel-title">
                            <i class="fa fa-filter"></i>
                            #{etiquetas['aplicacion.general.filtros']}
                            <span class="pull-right">                   
                                <a href="#" class="panel-minimize"><i class="fa fa-chevron-up"></i></a>                  
                            </span>
                        </h3>
                    </div>

                    <div class="panel-body">
                        <div >
                            <h:panelGrid columns="2">
                                <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.periodo']}" for="periodo" styleClass="lbl-h2" /> 
                                <p:selectOneMenu id ="periodo" value="#{consultaCalificacion.periodo}"
                                                 converter="omnifaces.SelectItemsConverter">
                                    <f:selectItems value="#{consultaCalificacion.listaPeriodos}"                                                      
                                                   var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item, usuarioSesion.longitudItemOmnifaces('COMBO'))}"/>
                                    <p:ajax update="panelDivGeografica,filtroAgrupamiento" listener="#{consultaCalificacion.cambioPeriodo}"/> 
                                    <p:ajax update="camposOpcinales,filtroGeografico,resulConsulta" listener="#{consultaCalificacion.resetearFiltros}"/>                                
                                </p:selectOneMenu> 
                            </h:panelGrid>
                            <p:spacer height="20"/>

                        </div> 
                        <div class="row">        
                            <p:panelGrid columns="2" styleClass="anchoTabla100" columnClasses="panelGoe,panelAtri">
                                <p:panel header="#{etiquetas['aplicacion.general.filtros.panel.geograficos']}" style="overflow: auto;" styleClass="altoPanelBusqueda" >
                                    <h:panelGrid columns="4" columnClasses="anchoColumnna50,anchoColumnna50" styleClass="anchoTabla100">
                                        <h:panelGrid id="panelDivGeografica" columns="2">
                                            <p:outputLabel rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA==1}" value="#{consultaCalificacion.consultaAmbito.listaNivelesConf[1]}" for="nivelInicial" styleClass="lbl-filtro"/> 
                                            <p:outputLabel rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA==2}" value="#{consultaCalificacion.consultaAmbito.listaNivelesConf[2]}" for="nivelInicial" styleClass="lbl-filtro"/> 
                                            <p:outputLabel rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA==3}" value="#{consultaCalificacion.consultaAmbito.listaNivelesConf[3]}" for="nivelInicial" styleClass="lbl-filtro"/> 
                                            <p:outputLabel rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA==4}" value="#{consultaCalificacion.consultaAmbito.listaNivelesConf[4]}" for="nivelInicial" styleClass="lbl-filtro"/> 
                                            <p:outputLabel rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA==5}" value="#{consultaCalificacion.consultaAmbito.listaNivelesConf[5]}" for="nivelInicial" styleClass="lbl-filtro"/> 
                                            <h:outputText id="nivelInicial" rendered="#{consultaCalificacion.consultaAmbito.minimoNivelDPA!=0}" value="#{consultaCalificacion.consultaAmbito.nombreDPAInicial}" />

                                            <p:outputLabel value="#{consultaCalificacion.listaNivelesConf[1]}" for="nivel1" 
                                                           rendered="#{consultaCalificacion.consultaAmbito.activoNivel1}" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="nivel1" styleClass="combo"
                                                             rendered="#{consultaCalificacion.consultaAmbito.activoNivel1}"
                                                             value="#{consultaCalificacion.consultaAmbito.seleccionNivel1}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.consultaAmbito.listaNivel1}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.descripcion, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="panelDivGeografica" listener="#{consultaCalificacion.consultaAmbito.cambioNivel1}"/>    
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{consultaCalificacion.listaNivelesConf[2]}" for="nivel2"
                                                           rendered="#{consultaCalificacion.consultaAmbito.activoNivel2}" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="nivel2" styleClass="combo"
                                                             rendered="#{consultaCalificacion.consultaAmbito.activoNivel2}"
                                                             disabled="#{consultaCalificacion.consultaAmbito.seleccionNivel1 eq null}"
                                                             value="#{consultaCalificacion.consultaAmbito.seleccionNivel2}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.consultaAmbito.listaNivel2}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.descripcion, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="panelDivGeografica" listener="#{consultaCalificacion.consultaAmbito.cambioNivel2}"/>  
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{consultaCalificacion.listaNivelesConf[3]}" for="nivel3"
                                                           rendered="#{consultaCalificacion.consultaAmbito.activoNivel3}" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="nivel3" styleClass="combo"
                                                             rendered="#{consultaCalificacion.consultaAmbito.activoNivel3}"
                                                             disabled="#{consultaCalificacion.consultaAmbito.seleccionNivel2 eq null}"
                                                             value="#{consultaCalificacion.consultaAmbito.seleccionNivel3}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.consultaAmbito.listaNivel3}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.descripcion, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="panelDivGeografica" listener="#{consultaCalificacion.consultaAmbito.cambioNivel3}"/>  
                                            </p:selectOneMenu>                                   

                                            <p:outputLabel value="#{consultaCalificacion.listaNivelesConf[4]}" for="nivel4" 
                                                           rendered="#{consultaCalificacion.consultaAmbito.activoNivel4}" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="nivel4" styleClass="combo"
                                                             rendered="#{consultaCalificacion.consultaAmbito.activoNivel4}"
                                                             disabled="#{consultaCalificacion.consultaAmbito.seleccionNivel3 eq null}"
                                                             value="#{consultaCalificacion.consultaAmbito.seleccionNivel4}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.consultaAmbito.listaNivel4}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.descripcion, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="panelDivGeografica" listener="#{consultaCalificacion.consultaAmbito.cambioNivel4}"/>  
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{consultaCalificacion.listaNivelesConf[5]}" for="nivel4" 
                                                           rendered="#{consultaCalificacion.consultaAmbito.activoNivel5}" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="nivel5" styleClass="combo"
                                                             rendered="#{consultaCalificacion.consultaAmbito.activoNivel5}"
                                                             disabled="#{consultaCalificacion.consultaAmbito.seleccionNivel4 eq null}"
                                                             value="#{consultaCalificacion.consultaAmbito.seleccionNivel5}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.consultaAmbito.listaNivel5}"                                                      
                                                               var="valor" itemValue="#{valor}" itemLabel="#{of:abbreviate(valor.descripcion, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="panelDivGeografica" listener="#{consultaCalificacion.consultaAmbito.cambioNivel5}"/> 
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.establecimiento']}" for="establecimiento" rendered="false" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="establecimiento" styleClass="combo" rendered="false"
                                                             disabled="#{consultaCalificacion.ultimoNivelDPA eq null}"
                                                             value="#{consultaCalificacion.seleccionEst}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.listaEstablecimientos}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.nombre, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="sede,predio" listener="#{consultaCalificacion.cambioEstablecimiento}"/>  
                                            </p:selectOneMenu>                                   

                                            <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.sede']}" for="sede" rendered="false" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="sede" styleClass="combo" rendered="false"
                                                             disabled="#{consultaCalificacion.seleccionEst eq null}"
                                                             value="#{consultaCalificacion.seleccionSede}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.listaSedes}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.nombre, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                                <p:ajax update="predio" listener="#{consultaCalificacion.cambioSede}"/>  
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.predio']}" for="predio" rendered="false" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="predio" styleClass="combo" rendered="false"
                                                             disabled="#{consultaCalificacion.seleccionSede eq null}"
                                                             value="#{consultaCalificacion.seleccionPredio}"
                                                             converter="omnifaces.SelectItemsConverter" >
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.listaPredios}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.nombre, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                            </p:selectOneMenu> 
                                        </h:panelGrid>  
                                        <h:panelGrid id="filtroGeografico" columns="2">
                                            <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.sector']}" for="sector" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="sector"  styleClass="combo"
                                                             value="#{consultaCalificacion.seleccionSector}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.listaSectores}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.nombre, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                            </p:selectOneMenu> 

                                            <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.zona']}" for="zona" styleClass="lbl-filtro"/> 
                                            <p:selectOneMenu id="zona"  styleClass="combo"
                                                             value="#{consultaCalificacion.seleccionZona}"
                                                             converter="omnifaces.SelectItemsConverter">
                                                <f:selectItem itemLabel="" itemValue="#{null}"/>  
                                                <f:selectItems value="#{consultaCalificacion.listaZonas}"                                                      
                                                               var="item" itemValue="#{item}" itemLabel="#{of:abbreviate(item.nombre, usuarioSesion.longitudItemOmnifaces('COMBO_FILTRO_CONSULTA'))}"/>
                                            </p:selectOneMenu> 
                                        </h:panelGrid>  
                                    </h:panelGrid> 
                                </p:panel>

                            </p:panelGrid>


                        </div>
                        <div class="row">
                            <!-- Separador -->
                            <div class="col-md-12">
                                <p:spacer height="20" width="20" />
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6">
                                <h:panelGrid id="filtroAgrupamiento" columns="2">
                                    <p:outputLabel value="#{etiquetas['aplicacion.general.filtros.resultados']}" for="agrupamiento" styleClass="lbl-h2"/> 
                                    <p:selectOneMenu id="agrupamiento" value="#{consultaCalificacion.seleccionAgrupamiento}"
                                                     converter="omnifaces.SelectItemsConverter">
                                        <f:selectItems value="#{consultaCalificacion.listaAgrupamientos.entrySet()}"
                                                       var="agrupamiento" itemValue="#{agrupamiento.key}" itemLabel="#{of:abbreviate(agrupamiento.value, usuarioSesion.longitudItemOmnifaces('COMBO'))}"/>                                        
                                        <p:ajax update="dpaForm" listener="#{consultaCalificacion.cambioAgrupamiento}"/>
                                    </p:selectOneMenu>
                                </h:panelGrid>
                            </div>
                            <div class="col-md-6">
                                <h:panelGrid styleClass="button-bar" columns="3">
                                    <p:commandButton value="#{etiquetas['aplicacion.general.consultar']}" styleClass="btn-success" image="ui-icon-search"
                                                     actionListener="#{consultaCalificacion.consultar}"
                                                     update="resulConsulta"/>
                                    <p:commandButton value="#{etiquetas['aplicacion.general.resetear']}" styleClass="btn-success" image="ui-icon-refresh"
                                                     update="dpaForm"
                                                     actionListener="#{consultaCalificacion.resetearFiltros}"/>
                                </h:panelGrid>      
                            </div>
                        </div>

                    </div> <!-- /panel body -->
                </div>
            </div>
            <div class="col-md-12">
                <div class="panel">
                    <div class="panel-heading text-primary">
                        <h3 class="panel-title">
                            <i class="fa fa-table"></i>
                            #{etiquetas['aplicacion.general.resul']}
                            <span class="pull-right">                   
                                <a href="#" class="panel-minimize"><i class="fa fa-chevron-up"></i></a>                  
                            </span>
                        </h3>
                    </div>
                    <div class="panel-body">
                        <h:panelGrid columns="2" style="float: left;font-size: 10px;">                             
                            <p:selectCheckboxMenu id ="camposOpcinales" styleClass="btn-success"
                                                  label="#{of:abbreviate(etiquetas['aplicacion.general.seleccionarCampos'], usuarioSesion.longitudItemOmnifaces('COMBO'))}"
                                                  value="#{consultaCalificacion.selccionCamposOpcionales}" 
                                                  disabled="#{empty consultaCalificacion.listaCamposOpcionales}">
                                <f:selectItems value="#{consultaCalificacion.listaCamposOpcionales}" var="item" itemLabel="#{of:abbreviate(item, usuarioSesion.longitudItemOmnifaces('COMBO'))}" />  
                            </p:selectCheckboxMenu>
                            <p:commandLink styleClass="btn fa fa-check" title="#{of:abbreviate(etiquetas['aplicacion.general.aplicar'], usuarioSesion.longitudItemOmnifaces('TOOLTIP'))}"  update="camposOpcinales,resulConsulta"/>                            
                        </h:panelGrid>

                        <h:panelGroup styleClass="button-bar">
                            <p:commandButton ajax="false" styleClass="exportarExcel" value="#{etiquetas['aplicacion.general.exportarExcel']}" immediate="true">
                                <h:graphicImage name="images/excel.png" />  
                                <p:dataExporter type="xls" target="resulConsulta" 
                                                fileName="#{etiquetas['consultas.calificacion.filename']}"
                                                postProcessor="#{consultaCalificacion.postProcessXLS}"
                                                />  
                            </p:commandButton>  
                        </h:panelGroup> 
                        <p:spacer  height="5" />
                        <p:dataTable id="resulConsulta"    var="item" value="#{consultaCalificacion.lista}" rows="10"
                                     paginator="true" paginatorPosition="bottom" paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} {CurrentPageReport} {NextPageLink} {LastPageLink}"
                                     rowsPerPageTemplate="10,20,40,80"
                                     scrollable="true" scrollHeight="350"
                                     emptyMessage="#{etiquetas['aplicacion.general.noExistenRegistros']}"  
                                     styleClass="tablaConsultas">  
                            
                             <p:column  width="150" sortBy="nivel0"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[0])}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[0]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel0}" />  
                            </p:column> 

                            <p:column  width="150" sortBy="codNivel1"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodNiv1)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodNiv1}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codNivel1}" />  
                            </p:column>
                            
                            <p:column  width="150" sortBy="nivel1"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[1])}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[1]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel1}" />  
                            </p:column> 
                            
                            <p:column  width="150" sortBy="codNivel2"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodNiv2)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodNiv2}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codNivel2}" />  
                            </p:column>
                            
                            <p:column width="150" sortBy="nivel2"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[2])}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[2]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel2}" />  
                            </p:column> 
                            
                            <p:column  width="150" sortBy="codNivel3"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodNiv3)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodNiv3}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codNivel3}" />  
                            </p:column>

                            <p:column width="150" sortBy="nivel3"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[3])}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[3]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel3}" />  
                            </p:column>
                            
                            <p:column  width="150" sortBy="codNivel4"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodNiv4)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodNiv4}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codNivel4}" />  
                            </p:column>
                           
                            <p:column width="150" sortBy="nivel4"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[4])}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[4]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel4}" />  
                            </p:column> 
                            
                            <p:column  width="150" sortBy="codNivel5"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodNiv5)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodNiv5}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codNivel5}" />  
                            </p:column>
                            
                            <p:column width="150" sortBy="nivel5"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.listaNivelesConf[5])}"> 
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.listaNivelesConf[5]}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nivel5}" />  
                            </p:column>                   

                            <p:column width="170" sortBy="codEstablecimiento"
                                      filterMatchMode="contains" filterStyle="background-color: #ebeff2;"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodEst)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodEst}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codEstablecimiento}" />  
                            </p:column>  

                            <p:column width="170" sortBy="nomEstablecimiento"
                                      filterMatchMode="contains" filterStyle="background-color: #ebeff2;"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaNomEst)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaNomEst}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nomEstablecimiento}" />  
                            </p:column>  

                            <p:column width="170" sortBy="codSede"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodSede)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodSede}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codSede}"/>  
                            </p:column>  

                            <p:column width="170" sortBy="nomSede"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaNomSede)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaNomSede}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nomSede}" />  
                            </p:column>  

                            <p:column  width="170" sortBy="codPredio"
                                       rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCodPredio)}">  
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaCodPredio}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.codPredio}" />  
                            </p:column>  

                            <p:column width="170" sortBy="nomPredio"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaNomPredio)}"> 
                                <f:facet name="header">  
                                    <h:outputText value="#{consultaCalificacion.columnaNomPredio}" styleClass="tituloCalificacion" />  
                                </f:facet>  
                                <h:outputText value="#{item.nomPredio}" />  
                            </p:column>                                        

                            <p:column width="80" sortBy="accesosExt" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaAccesosExt)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaAccesosExt)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaAccesosExt)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.accesosExt}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="accesosInt" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaAccesosInt)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaAccesosInt)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaAccesosInt)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>                                    
                                </f:facet>  
                                <h:outputText value="#{item.accesosInt}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="ambientes" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaAmbientes)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaAmbientes)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaAmbientes)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.ambientes}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="confort" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaConfort)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaConfort)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaConfort)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table> 
                                </f:facet>  
                                <h:outputText value="#{item.confort}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="controlVigilancia" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaControlVigilancia)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaControlVigilancia)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaControlVigilancia)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.controlVigilancia}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="estadoEdificiosEspacios" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaEstadoEdificiosEspacios)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaEstadoEdificiosEspacios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaEstadoEdificiosEspacios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table> 
                                </f:facet>  
                                <h:outputText value="#{item.estadoEdificiosEspacios}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="oferta" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaOferta)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaOferta)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaOferta)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.oferta}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="propiedad" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaPropiedad)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaPropiedad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaPropiedad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.propiedad}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="riesgos" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaRiesgos)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaRiesgos)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaRiesgos)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.riesgos}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="seguridad" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaSeguridad)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaSeguridad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaSeguridad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.seguridad}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="servicios" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaServicios)}">
                                <f:facet name="header"> 
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaServicios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaServicios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>  
                                </f:facet>  
                                <h:outputText value="#{item.servicios}" />                                  
                            </p:column>                            

                            <p:column width="80" sortBy="sostenibilidad" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaSostenibilidad)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaSostenibilidad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaSostenibilidad)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.sostenibilidad}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="serviciosSanitarios" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaServiciosSanitarios)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaServiciosSanitarios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaServiciosSanitarios)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>  
                                </f:facet>  
                                <h:outputText value="#{item.serviciosSanitarios}" />                                  
                            </p:column> 

                            <p:column width="80" sortBy="calificacionTotal" styleClass="campoNumero"
                                      rendered="#{consultaCalificacion.isMostrarCamposOpcional(consultaCalificacion.columnaCalificacionTotal)}">
                                <f:facet name="header">  
                                    <table class="noBorder">
                                        <tr class="noBorder">
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarPonderacion(consultaCalificacion.columnaCalificacionTotal)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                        <tr class="noBorder">  
                                            <td class="noBorder">
                                                <h:outputText value="#{consultaCalificacion.separarNombre(consultaCalificacion.columnaCalificacionTotal)}" styleClass="tituloCalificacion" />  
                                            </td>
                                        </tr>
                                    </table>
                                </f:facet>  
                                <h:outputText value="#{item.calificacionTotal}" />                                  
                            </p:column> 

                            <p:column width="30" style="text-align: center" exportable="false">  
                                <f:facet name="header">                                   
                                </f:facet>
                                <h:outputLabel rendered="#{consultaCalificacion.isCalificacionOK(item.calificacionTotal)}" >
                                    <li class="fa fa-circle ok" style="font-size:16px"/>
                                </h:outputLabel>
                                <h:outputLabel  rendered="#{consultaCalificacion.isCalificacionNoOK(item.calificacionTotal)}" >
                                    <li class="fa fa-circle no" style="font-size: 16px" />
                                </h:outputLabel>
                                <h:outputLabel rendered="#{consultaCalificacion.isCalificacionRegular(item.calificacionTotal)}" >
                                    <li class="fa fa-circle regular" style="font-size: 16px"  />
                                </h:outputLabel>
                            </p:column>
                            <p:column width="30" exportable="false"> 
                                <f:facet name="header">  
                                    <h:outputText value="" />  
                                </f:facet>

                                <p:commandLink value="" rendered="#{!InformeGeneralBean.posibilidadDosInformes(item.nivel)}" ajax="false" 
                                               title="#{of:abbreviate(etiquetas['aplicacion.general.imprimir'], usuarioSesion.longitudItemOmnifaces('TOOLTIP'))}" immediate="true" styleClass="fa fa-file-text" style="font-size: 18px;" 
                                               onclick="PrimeFaces.monitorDownload(start, finish);">
                                    <p:fileDownload value="#{InformeGeneralBean.imprimirPdf(item.nivel ,item.id, item.cod, 'Totales')}" ></p:fileDownload>
                                </p:commandLink>

                                <p:commandLink style="font-size: 20px;"
                                               rendered="#{InformeGeneralBean.posibilidadDosInformes(item.nivel)}"
                                               oncomplete="PF('confirmacion#{item.cod}').show();"
                                               title="#{of:abbreviate(etiquetas['aplicacion.general.imprimir'], usuarioSesion.longitudItemOmnifaces('TOOLTIP'))}" styleClass="fa fa-file-text"
                                               immediate="true">                                  
                                </p:commandLink>

                                <p:confirmDialog id="confirmacion#{item.cod}" widgetVar="confirmacion#{item.cod}" 
                                                 message="#{etiquetas['consulta.calificacion.preguntaInformes']}"
                                                 rendered="#{InformeGeneralBean.posibilidadDosInformes(item.nivel)}">
                                    <h:commandLink value="" 
                                                   title="#{of:abbreviate(etiquetas['aplicacion.general.imprimir'], usuarioSesion.longitudItemOmnifaces('TOOLTIP'))}" immediate="true"
                                                   onclick="PF('confirmacion#{item.cod}').hide();
                                                       PrimeFaces.monitorDownload(start, finish);">
                                        <p:commandButton value="#{etiquetas['consulta.calificacion.informeDetallado']}" type="button" styleClass="ui-confirmdialog-no" />
                                        <p:fileDownload value="#{InformeGeneralBean.imprimirPdf(item.nivel ,item.id, item.cod, 'Detalles')}" ></p:fileDownload>
                                    </h:commandLink>
                                    <h:commandLink value=""
                                                   title="#{of:abbreviate(etiquetas['aplicacion.general.imprimir'], usuarioSesion.longitudItemOmnifaces('TOOLTIP'))}" immediate="true"
                                                   onclick="PF('confirmacion#{item.cod}').hide();
                                                       PrimeFaces.monitorDownload(start, finish);">
                                        <p:commandButton value="#{etiquetas['consulta.calificacion.informeTotales']}" type="button" styleClass="ui-confirmdialog-no" />
                                        <p:fileDownload value="#{InformeGeneralBean.imprimirPdf(item.nivel ,item.id, item.cod, 'Totales')}" ></p:fileDownload>
                                    </h:commandLink>
                                </p:confirmDialog>
                            </p:column> 

                            <f:facet name="footer" class="footerTabla">  
                                <h:outputText value="#{etiquetas['aplicacion.general.total.registros']} #{consultaCalificacion.lista.size()}" >
                                    <f:convertNumber pattern="#{consultaCalificacion.formatoEntero}" />
                                </h:outputText>  
                            </f:facet> 
                        </p:dataTable>  
                    </div> <!-- /panel body -->
                </div>
                <ui:include src="../../resources/loading-dialog.xhtml">
                    <ui:param name="texto" value="#{etiquetas['aplicacion.general.generando.informe']}"/>
                </ui:include>
            </div>
        </h:form> 
    </ui:define>
</ui:composition>      
